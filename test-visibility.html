<!DOCTYPE html>
<html>
<head>
    <title>Test Genie Animation</title>
    <style>
        .is-hidden {
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
        }

        @keyframes genieAppear {
            0% {
                opacity: 0;
                transform: scale(0.1) translateY(50px) rotate(-5deg);
                filter: blur(4px);
            }
            40% {
                opacity: 0.8;
                transform: scale(0.6) translateY(20px) rotate(-2deg);
                filter: blur(2px);
            }
            70% {
                opacity: 1;
                transform: scale(1.05) translateY(-5px) rotate(0deg);
                filter: blur(0px);
            }
            85% {
                transform: scale(0.98) translateY(2px) rotate(0deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0) rotate(0deg);
                filter: blur(0px);
            }
        }

        .genie-appear {
            animation: genieAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            transform-origin: bottom center;
            visibility: visible !important;
            pointer-events: auto !important;
            opacity: 0;
        }

        .test-window {
            width: 300px;
            height: 200px;
            background: #f5f0e1;
            border: 2px solid #2a2a2e;
            margin: 100px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <button onclick="testGenie()">Test Genie Effect</button>
    <div class="test-window is-hidden" id="testWindow">
        Test Window
    </div>

    <script>
        function testGenie() {
            const win = document.getElementById('testWindow');
            console.log('Before:', win.classList);
            
            win.classList.remove('is-hidden');
            win.offsetHeight;
            win.classList.add('genie-appear');
            
            console.log('After:', win.classList);
            
            win.addEventListener('animationend', function cleanup() {
                console.log('Animation ended');
                win.classList.remove('genie-appear');
                win.removeEventListener('animationend', cleanup);
            }, { once: true });
        }
    </script>
</body>
</html>
