<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genie Animation Test</title>
    <style>
        body {
            background: #3d3d3d;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .is-hidden {
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
        }

        @keyframes genieAppear {
            0% {
                opacity: 0;
                transform: scale(0.1) translateY(50px) rotate(-5deg);
                filter: blur(4px);
            }
            40% {
                opacity: 0.8;
                transform: scale(0.6) translateY(20px) rotate(-2deg);
                filter: blur(2px);
            }
            70% {
                opacity: 1;
                transform: scale(1.05) translateY(-5px) rotate(0deg);
                filter: blur(0px);
            }
            85% {
                transform: scale(0.98) translateY(2px) rotate(0deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0) rotate(0deg);
                filter: blur(0px);
            }
        }

        .genie-appear {
            animation: genieAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            transform-origin: bottom center;
            visibility: visible !important;
            pointer-events: auto !important;
        }

        .window {
            background: #f5f0e1;
            border: 2px solid #2a2a2e;
            border-radius: 4px;
            box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.3);
            width: 320px;
            padding: 16px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <button onclick="testGenie()">Test Genie Animation</button>
    <div class="window is-hidden" id="testWindow">
        <h2>Recently deleted</h2>
        <p>Test content for the genie animation effect.</p>
    </div>

    <script>
        function testGenie() {
            const win = document.getElementById('testWindow');
            
            // Method 1: The current approach
            win.style.opacity = '0';
            win.style.transform = 'scale(0.1) translateY(50px) rotate(-5deg)';
            win.style.filter = 'blur(4px)';
            
            win.classList.remove('is-hidden');
            win.offsetHeight;
            
            win.style.opacity = '';
            win.style.transform = '';
            win.style.filter = '';
            win.classList.add('genie-appear');
            
            win.addEventListener('animationend', function cleanup() {
                console.log('Animation ended');
                win.classList.remove('genie-appear');
                win.removeEventListener('animationend', cleanup);
            }, { once: true });
        }
    </script>
</body>
</html>
