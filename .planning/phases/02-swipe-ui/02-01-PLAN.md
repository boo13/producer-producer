---
phase: 02-swipe-ui
plan: 01
type: execute
---

<objective>
Build the mobile-first job card UI component and card stack rendering.

Purpose: Create the visual foundation for the swipe loop - full-screen job cards that users can swipe through.
Output: Job cards rendering from API data, styled for mobile, ready for swipe integration.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-01-SUMMARY.md

# Key files from Phase 1:
@v2/index.html
@v2/js/api.js
@v2/js/auth.js
@v2/js/swipe.js
@v2/css/styles.css

# Reference for opportunity data structure:
@js/opportunities.js (lines 158-231 for card HTML structure and data fields)

**Tech stack available:**
- VT323 font (terminal aesthetic)
- SwipeManager with overlay support (.swipe-overlay-left, .swipe-overlay-right)
- APIClient with getOpportunityFeed(), getUserOpportunities(), updateOpportunityStatus()
- pp:auth-changed custom event

**Established patterns:**
- IIFE modules exposing via window.*
- kebab-case CSS classes, BEM for components
- Mobile-first (430px max-width container)
- Console logging for states until UI components exist

**Constraining decisions:**
- Phase 1: auth.js dispatches pp:auth-changed event (UI listens, doesn't query DOM)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create job card CSS component</name>
  <files>v2/css/styles.css</files>
  <action>
Add CSS for full-screen swipeable job cards:

1. `.card-stack` - Container for cards, positioned to allow stacking
2. `.job-card` - Full-screen card (fills available height minus nav space)
   - Dark background (#252525) with subtle border
   - Padding for content
   - Touch-action: pan-y to allow vertical scroll but capture horizontal
   - Position: absolute for stacking (top card z-index higher)
3. `.job-card__header` - Company logo placeholder + title area
4. `.job-card__title` - Job title (large, VT323)
5. `.job-card__company` - Company name (slightly smaller)
6. `.job-card__meta` - Location, salary, date (smaller, dimmer #888)
7. `.job-card__score` - Score badge (optional, small)
8. `.swipe-overlay-left`, `.swipe-overlay-right` - IGNORE/SAVE overlays
   - Position absolute, full card
   - opacity: 0 by default (SwipeManager controls)
   - Left: red tint with "NOPE" text
   - Right: green tint with "SAVE" text
9. `.job-card.is-swipe-active` - No transition while dragging
10. Empty state `.empty-state` - "No more jobs" message

Keep terminal aesthetic: #1a1a1a background, #00ff00 accents, VT323 font.
  </action>
  <verify>Open v2/index.html in browser, inspect CSS is loaded without errors</verify>
  <done>CSS classes defined for card stack, job card, overlays, and empty state</done>
</task>

<task type="auto">
  <name>Task 2: Create opportunities module for v2</name>
  <files>v2/js/opportunities.js, v2/index.html</files>
  <action>
Create v2/js/opportunities.js module that:

1. State management:
   - `opportunities` array (current deck)
   - `currentIndex` (which card is on top)
   - `actionHistory` for undo

2. `loadOpportunities()` async function:
   - If authenticated: fetch from getOpportunityFeed(), filter out ignored/applied via getUserOpportunities()
   - If not authenticated: fetch public feed only
   - Store in state, call renderCards()

3. `renderCards()` function:
   - Clear card stack container
   - If no opportunities: show empty state
   - Create card elements for top 3 opportunities (for smooth transitions)
   - Top card (currentIndex) gets highest z-index, is interactive
   - Next 2 cards visible underneath (slightly scaled/offset for depth effect)

4. `createCardElement(opportunity)` function:
   - Build card HTML with:
     - .swipe-overlay-left (NOPE)
     - .swipe-overlay-right (SAVE)
     - .job-card__title (opportunity.title)
     - .job-card__company (opportunity.company_name || 'Unknown Company')
     - .job-card__meta (location, salary, date - use helper functions)
   - Return DOM element

5. Helper functions (copy from v1 opportunities.js):
   - `formatSalary(min, max)`
   - `formatLocation(opp)`
   - `formatDate(dateString)`
   - `escapeHtml(text)`

6. Listen for pp:auth-changed event to reload opportunities

7. Export via window.opportunitiesV2 = { loadOpportunities, ... }

Update v2/index.html:
- Add `<div class="card-stack" id="card-stack"></div>` inside #app
- Add script tag for opportunities.js after swipe.js
  </action>
  <verify>
1. Run `python3 -m http.server 8080` in project root
2. Open http://localhost:8080/v2/ in browser
3. Check console for "Loading opportunities..." log
4. Check Network tab for API call to /opportunities/feed
5. Check that cards render (or empty state if no data)
  </verify>
  <done>
- opportunities.js module exists and loads
- Cards render from API data
- Card HTML structure matches CSS classes
- Empty state shows when no opportunities
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] v2/css/styles.css has card component styles
- [ ] v2/js/opportunities.js exists and exports window.opportunitiesV2
- [ ] Cards render from API data (check Network tab)
- [ ] Cards have correct HTML structure for swipe overlays
- [ ] Empty state displays when no opportunities
- [ ] No console errors
</verification>

<success_criteria>

- Job cards render with visual styling
- Card stack shows top card prominently
- Swipe overlay elements exist (opacity 0, ready for SwipeManager)
- Module listens to pp:auth-changed for reload
- Empty state handles edge case
</success_criteria>

<output>
After completion, create `.planning/phases/02-swipe-ui/02-01-SUMMARY.md`
</output>
